# Travel Helper í”„ë¡œì íŠ¸ êµ¬ì¡°

> **Version**: 3.0.0
> **Last Updated**: 2026-01-27
> **Stack**: pnpm Monorepo + Turborepo

---

## 1. ê°œìš”

Travel HelperëŠ” í•´ì™¸ ì—¬í–‰ ì§€ì¶œ ê´€ë¦¬ë¥¼ ìœ„í•œ í’€ìŠ¤íƒ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ì‚¬ìš©ì (Mobile App)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Backend API (NestJS)                      â”‚
â”‚  - ì¸ì¦ (JWT)                                                â”‚
â”‚  - ì—¬í–‰/ì§€ì¶œ CRUD                                            â”‚
â”‚  - AI í”„ë¡ì‹œ (ì˜ìˆ˜ì¦ OCR, ì±—ë´‡)                               â”‚
â”‚  - ë°ì´í„° ë™ê¸°í™”                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Supabase PostgreSQL  â”‚   â”‚   AI Provider (LLM)   â”‚
â”‚  - ì‚¬ìš©ì ë°ì´í„°        â”‚   â”‚  - OpenAI / Groq      â”‚
â”‚  - ì—¬í–‰/ì§€ì¶œ ë°ì´í„°     â”‚   â”‚  - ì˜ìˆ˜ì¦ OCR         â”‚
â”‚  - ì±„íŒ… íˆìŠ¤í† ë¦¬        â”‚   â”‚  - ì±—ë´‡               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
wigtn-travel-helper/
â”œâ”€â”€ apps/                          # ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ api/                       # Backend API (NestJS)
â”‚   â””â”€â”€ mobile/                    # Mobile App (Expo/React Native)
â”‚
â”œâ”€â”€ packages/                      # ê³µìœ  íŒ¨í‚¤ì§€
â”‚   â””â”€â”€ shared/                    # ê³µìœ  íƒ€ì… & ìƒìˆ˜ (@wigtn/shared)
â”‚
â”œâ”€â”€ docs/                          # ë¬¸ì„œ
â”‚   â”œâ”€â”€ prd/                       # PRD ë¬¸ì„œë“¤
â”‚   â”œâ”€â”€ architecture/              # ì•„í‚¤í…ì²˜ ë¬¸ì„œ
â”‚   â””â”€â”€ todo_plan/                 # êµ¬í˜„ ê³„íš
â”‚
â”œâ”€â”€ docker/                        # Docker ì„¤ì •
â”‚
â”œâ”€â”€ package.json                   # Root package.json (Monorepo)
â”œâ”€â”€ pnpm-workspace.yaml            # pnpm ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì„¤ì •
â””â”€â”€ turbo.json                     # Turborepo ì„¤ì •
```

---

## 3. íŒ¨í‚¤ì§€ ìƒì„¸

### 3.1 `packages/shared` (@wigtn/shared)

**ì—­í• **: í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œê°€ ê³µìœ í•˜ëŠ” **íƒ€ì… ì •ì˜ì˜ Single Source of Truth (SSOT)**

```
packages/shared/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”œâ”€â”€ common.ts        # BaseEntity, Pagination
â”‚   â”‚   â”œâ”€â”€ user.ts          # User, Auth DTOs
â”‚   â”‚   â”œâ”€â”€ trip.ts          # Trip, Destination
â”‚   â”‚   â”œâ”€â”€ expense.ts       # Expense, Category, PaymentMethod
â”‚   â”‚   â”œâ”€â”€ exchange-rate.ts # ExchangeRates, Currency
â”‚   â”‚   â”œâ”€â”€ ai.ts            # Receipt OCR, Chat
â”‚   â”‚   â”œâ”€â”€ sync.ts          # ì˜¤í”„ë¼ì¸ ë™ê¸°í™”
â”‚   â”‚   â”œâ”€â”€ upload.ts        # ì´ë¯¸ì§€ ì—…ë¡œë“œ
â”‚   â”‚   â”œâ”€â”€ api.ts           # API Response ë˜í¼
â”‚   â”‚   â””â”€â”€ wallet.ts        # (MVP ì œì™¸) ì§€ê°‘
â”‚   â”‚
â”‚   â”œâ”€â”€ constants.ts         # CATEGORIES, CURRENCIES, VALIDATION
â”‚   â””â”€â”€ index.ts             # re-export
â”‚
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```typescript
// apps/apiì—ì„œ
import { CreateExpenseDto, CATEGORIES } from '@wigtn/shared';

// apps/mobileì—ì„œ
import { Trip, Expense, Category } from '@wigtn/shared';
```

---

### 3.2 `apps/api` (@wigtn/api)

**ì—­í• **: REST API ë°±ì—”ë“œ ì„œë²„

**ê¸°ìˆ  ìŠ¤íƒ**:
- **Framework**: NestJS 10.x
- **ORM**: Prisma 6.x
- **Database**: PostgreSQL (Supabase)
- **Auth**: JWT (Passport)
- **Docs**: Swagger (OpenAPI)

```
apps/api/
â”œâ”€â”€ prisma/
â”‚   â””â”€â”€ schema.prisma           # DB ìŠ¤í‚¤ë§ˆ ì •ì˜
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.ts                 # ì•± ì§„ì…ì 
â”‚   â”œâ”€â”€ app.module.ts           # ë£¨íŠ¸ ëª¨ë“ˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ configuration.ts    # í™˜ê²½ë³€ìˆ˜ ì„¤ì •
â”‚   â”‚
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”œâ”€â”€ database.module.ts  # DB ëª¨ë“ˆ
â”‚   â”‚   â””â”€â”€ prisma.service.ts   # Prisma ì„œë¹„ìŠ¤
â”‚   â”‚
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â””â”€â”€ interfaces/
â”‚   â”‚       â””â”€â”€ request.interface.ts  # ì¸ì¦ëœ ìš”ì²­ íƒ€ì…
â”‚   â”‚
â”‚   â””â”€â”€ modules/
â”‚       â”œâ”€â”€ auth/               # ì¸ì¦ ëª¨ë“ˆ
â”‚       â”‚   â”œâ”€â”€ auth.module.ts
â”‚       â”‚   â”œâ”€â”€ auth.controller.ts
â”‚       â”‚   â”œâ”€â”€ auth.service.ts
â”‚       â”‚   â”œâ”€â”€ dto/            # RegisterDto, LoginDto ë“±
â”‚       â”‚   â”œâ”€â”€ guards/         # JwtAuthGuard, LocalAuthGuard
â”‚       â”‚   â””â”€â”€ strategies/     # JWT, Local ì „ëµ
â”‚       â”‚
â”‚       â”œâ”€â”€ user/               # ì‚¬ìš©ì ëª¨ë“ˆ
â”‚       â”œâ”€â”€ trip/               # ì—¬í–‰ ëª¨ë“ˆ
â”‚       â”œâ”€â”€ expense/            # ì§€ì¶œ ëª¨ë“ˆ
â”‚       â”œâ”€â”€ exchange-rate/      # í™˜ìœ¨ ëª¨ë“ˆ
â”‚       â”œâ”€â”€ wallet/             # ì§€ê°‘ ëª¨ë“ˆ (MVP ì œì™¸)
â”‚       â”œâ”€â”€ sync/               # ë™ê¸°í™” ëª¨ë“ˆ
â”‚       â””â”€â”€ ai/                 # AI ëª¨ë“ˆ (OCR, ì±—ë´‡)
â”‚
â”œâ”€â”€ .env.example                # í™˜ê²½ë³€ìˆ˜ í…œí”Œë¦¿
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

**API ì—”ë“œí¬ì¸íŠ¸ ìš”ì•½**:

| ëª¨ë“ˆ | ì—”ë“œí¬ì¸íŠ¸ | ì„¤ëª… |
|------|-----------|------|
| Auth | `POST /auth/register` | íšŒì›ê°€ì… |
| | `POST /auth/login` | ë¡œê·¸ì¸ |
| | `POST /auth/social` | ì†Œì…œ ë¡œê·¸ì¸ |
| | `POST /auth/refresh` | í† í° ê°±ì‹  |
| | `GET /auth/me` | ë‚´ ì •ë³´ |
| Trip | `GET /trips` | ì—¬í–‰ ëª©ë¡ |
| | `POST /trips` | ì—¬í–‰ ìƒì„± |
| | `GET /trips/:id` | ì—¬í–‰ ìƒì„¸ |
| Expense | `GET /trips/:tripId/expenses` | ì§€ì¶œ ëª©ë¡ |
| | `POST /trips/:tripId/expenses` | ì§€ì¶œ ìƒì„± |
| | `GET /trips/:tripId/expenses/stats` | ì§€ì¶œ í†µê³„ |
| Sync | `POST /sync/push` | ë³€ê²½ì‚¬í•­ ì—…ë¡œë“œ |
| | `GET /sync/pull` | ë³€ê²½ì‚¬í•­ ë‹¤ìš´ë¡œë“œ |
| | `POST /sync/migrate` | ì´ˆê¸° ë§ˆì´ê·¸ë ˆì´ì…˜ |
| AI | `POST /ai/receipt/analyze` | ì˜ìˆ˜ì¦ OCR |
| | `POST /ai/receipt/analyze/batch` | ë°°ì¹˜ OCR |
| | `POST /ai/chat` | ì±—ë´‡ (ë™ê¸°) |
| | `POST /ai/chat/stream` | ì±—ë´‡ (ìŠ¤íŠ¸ë¦¬ë°) |

---

### 3.3 `apps/mobile` (@wigtn/mobile)

**ì—­í• **: iOS/Android ëª¨ë°”ì¼ ì•±

**ê¸°ìˆ  ìŠ¤íƒ**:
- **Framework**: Expo SDK 53 / React Native
- **Router**: Expo Router (íŒŒì¼ ê¸°ë°˜ ë¼ìš°íŒ…)
- **State**: Zustand
- **Local DB**: SQLite (expo-sqlite)
- **UI**: Custom Components + React Native

```
apps/mobile/
â”œâ”€â”€ app/                        # Expo Router (í˜ì´ì§€)
â”‚   â”œâ”€â”€ _layout.tsx             # ë£¨íŠ¸ ë ˆì´ì•„ì›ƒ
â”‚   â”œâ”€â”€ (tabs)/                 # íƒ­ ë„¤ë¹„ê²Œì´ì…˜
â”‚   â”‚   â”œâ”€â”€ _layout.tsx         # íƒ­ ë ˆì´ì•„ì›ƒ
â”‚   â”‚   â”œâ”€â”€ index.tsx           # í™ˆ (ì—¬í–‰ ëª©ë¡)
â”‚   â”‚   â”œâ”€â”€ calendar.tsx        # ìº˜ë¦°ë”
â”‚   â”‚   â”œâ”€â”€ stats.tsx           # í†µê³„
â”‚   â”‚   â””â”€â”€ settings.tsx        # ì„¤ì •
â”‚   â”‚
â”‚   â”œâ”€â”€ trip/
â”‚   â”‚   â”œâ”€â”€ new.tsx             # ì—¬í–‰ ìƒì„±
â”‚   â”‚   â””â”€â”€ [id].tsx            # ì—¬í–‰ ìƒì„¸
â”‚   â”‚
â”‚   â””â”€â”€ expense/
â”‚       â”œâ”€â”€ new.tsx             # ì§€ì¶œ ì…ë ¥
â”‚       â””â”€â”€ [id].tsx            # ì§€ì¶œ ìƒì„¸
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/                     # ê³µí†µ UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”œâ”€â”€ Card.tsx
â”‚   â”‚   â”œâ”€â”€ Input.tsx
â”‚   â”‚   â”œâ”€â”€ FAB.tsx
â”‚   â”‚   â”œâ”€â”€ BottomSheet.tsx
â”‚   â”‚   â”œâ”€â”€ CategoryIcon.tsx
â”‚   â”‚   â”œâ”€â”€ AmountDisplay.tsx
â”‚   â”‚   â”œâ”€â”€ ProgressBar.tsx
â”‚   â”‚   â””â”€â”€ EmptyState.tsx
â”‚   â”‚
â”‚   â””â”€â”€ layer/                  # ë·° ë ˆì´ì–´ ì»´í¬ë„ŒíŠ¸
â”‚       â”œâ”€â”€ CountryLayer.tsx    # êµ­ê°€ë³„ ë³´ê¸°
â”‚       â””â”€â”€ DayLayerView.tsx    # ì¼ë³„ ë³´ê¸°
â”‚
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ types.ts                # íƒ€ì… ì •ì˜ (â†’ @wigtn/sharedë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì˜ˆì •)
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/                 # Zustand ìŠ¤í† ì–´
â”‚   â”‚   â”œâ”€â”€ tripStore.ts        # ì—¬í–‰ ìƒíƒœ
â”‚   â”‚   â”œâ”€â”€ expenseStore.ts     # ì§€ì¶œ ìƒíƒœ
â”‚   â”‚   â”œâ”€â”€ exchangeRateStore.ts # í™˜ìœ¨ ìƒíƒœ
â”‚   â”‚   â””â”€â”€ settingsStore.ts    # ì„¤ì • ìƒíƒœ
â”‚   â”‚
â”‚   â”œâ”€â”€ db/                     # SQLite ë¡œì»¬ DB
â”‚   â”‚   â”œâ”€â”€ schema.ts           # í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â””â”€â”€ queries.ts          # CRUD ì¿¼ë¦¬
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                    # API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â””â”€â”€ exchangeRate.ts     # í™˜ìœ¨ API
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                  # ì»¤ìŠ¤í…€ í›…
â”‚   â”‚   â””â”€â”€ useTheme.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ theme/                  # ë””ìì¸ ì‹œìŠ¤í…œ
â”‚   â”‚   â”œâ”€â”€ colors.ts
â”‚   â”‚   â”œâ”€â”€ typography.ts
â”‚   â”‚   â”œâ”€â”€ spacing.ts
â”‚   â”‚   â”œâ”€â”€ shadows.ts
â”‚   â”‚   â””â”€â”€ animation.ts
â”‚   â”‚
â”‚   â””â”€â”€ utils/                  # ìœ í‹¸ë¦¬í‹°
â”‚       â”œâ”€â”€ currency.ts         # í†µí™” í¬ë§·íŒ…
â”‚       â”œâ”€â”€ date.ts             # ë‚ ì§œ ì²˜ë¦¬
â”‚       â”œâ”€â”€ uuid.ts             # UUID ìƒì„±
â”‚       â””â”€â”€ constants.ts        # ì•± ìƒìˆ˜
â”‚
â”œâ”€â”€ app.json                    # Expo ì„¤ì •
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

**í™”ë©´ êµ¬ì„±**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Travel Helper               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  [ì—¬í–‰ ëª©ë¡]                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ‡¯ğŸ‡µ ë„ì¿„ ì—¬í–‰                    â”‚    â”‚
â”‚  â”‚ 2026.01.15 - 2026.01.22        â”‚    â”‚
â”‚  â”‚ â‚©1,234,000 / â‚©2,000,000        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ‡«ğŸ‡· íŒŒë¦¬ ì—¬í–‰                    â”‚    â”‚
â”‚  â”‚ 2026.03.01 - 2026.03.10        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                         â”‚
â”‚                 [+]                     â”‚
â”‚                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ  í™ˆ    ğŸ“… ìº˜ë¦°ë”   ğŸ“Š í†µê³„   âš™ï¸ ì„¤ì •  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. ë°ì´í„° íë¦„

### 4.1 ì˜¤í”„ë¼ì¸ ìš°ì„  ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Mobile App                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚  Zustand    â”‚â—„â”€â”€â”€â”€â–ºâ”‚   SQLite    â”‚                   â”‚
â”‚  â”‚  (State)    â”‚      â”‚  (Local DB) â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚         â”‚                    â”‚                          â”‚
â”‚         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚         â”‚    â”‚         Sync Engine           â”‚         â”‚
â”‚         â”‚    â”‚  - ì˜¤í”„ë¼ì¸ í                  â”‚         â”‚
â”‚         â”‚    â”‚  - ì¶©ëŒ í•´ê²°                   â”‚         â”‚
â”‚         â”‚    â”‚  - ìë™ ì¬ì‹œë„                 â”‚         â”‚
â”‚         â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚ (ì¸í„°ë„· ì—°ê²° ì‹œ)
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Backend API                         â”‚
â”‚                          â”‚                              â”‚
â”‚                          â–¼                              â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                   â”‚  Supabase   â”‚                       â”‚
â”‚                   â”‚  PostgreSQL â”‚                       â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 AI ì˜ìˆ˜ì¦ OCR íë¦„

```
1. ì‚¬ìš©ìê°€ ì˜ìˆ˜ì¦ ì‚¬ì§„ ì´¬ì˜
           â”‚
           â–¼
2. Mobile â†’ API: POST /ai/receipt/analyze
   { image: "base64...", tripId: "..." }
           â”‚
           â–¼
3. API â†’ AI Provider (OpenAI/Groq)
   VLM ë¶„ì„ ìš”ì²­
           â”‚
           â–¼
4. AI Provider â†’ API: ReceiptAnalysis
   { store, date, total, currency, category, confidence }
           â”‚
           â–¼
5. API â†’ Mobile: ë¶„ì„ ê²°ê³¼ + ì§€ì¶œ ìë™ ìƒì„±
           â”‚
           â–¼
6. ì‚¬ìš©ì í™•ì¸/ìˆ˜ì • â†’ ì €ì¥
```

---

## 5. í™˜ê²½ ì„¤ì •

### 5.1 í•„ìˆ˜ í™˜ê²½ë³€ìˆ˜ (apps/api/.env)

```bash
# Database (Supabase)
DATABASE_URL="postgresql://..."      # Pooler (port 6543)
DIRECT_URL="postgresql://..."        # Direct (port 5432)

# JWT
JWT_SECRET="your-secret-key"
JWT_EXPIRES_IN="15m"
JWT_REFRESH_EXPIRES_IN="7d"

# AI Provider
AI_PROVIDER="groq"                   # groq | openai | self-hosted
GROQ_API_KEY="gsk_..."
OPENAI_API_KEY="sk-..."

# App
PORT=3000
NODE_ENV="development"
```

### 5.2 Supabase ì„¤ì •

1. [Supabase Dashboard](https://supabase.com/dashboard)ì—ì„œ í”„ë¡œì íŠ¸ ìƒì„±
2. **Settings** â†’ **Database** â†’ **Connection string** ë³µì‚¬
3. Transaction pooler (6543) â†’ `DATABASE_URL`
4. Session pooler (5432) â†’ `DIRECT_URL`

---

## 6. ì‹¤í–‰ ëª…ë ¹ì–´

### ê°œë°œ í™˜ê²½

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜
pnpm install

# ì „ì²´ ì‹¤í–‰ (API + Mobile)
pnpm dev

# ê°œë³„ ì‹¤í–‰
pnpm api dev          # APIë§Œ
pnpm mobile start     # Mobileë§Œ

# DB ê´€ë¦¬
pnpm db:migrate       # ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
pnpm db:studio        # Prisma Studio (DB GUI)
pnpm db:push          # ìŠ¤í‚¤ë§ˆ í‘¸ì‹œ (ê°œë°œìš©)
```

### ë¹Œë“œ

```bash
# ì „ì²´ ë¹Œë“œ
pnpm build

# ê°œë³„ ë¹Œë“œ
pnpm api build
pnpm shared build
```

### Docker (ì„ íƒ)

```bash
pnpm docker:up        # ê°œë°œ í™˜ê²½ Docker ì‹¤í–‰
pnpm docker:down      # Docker ì¢…ë£Œ
```

---

## 7. ì£¼ìš” ì˜ì¡´ì„±

### Backend (apps/api)

| íŒ¨í‚¤ì§€ | ë²„ì „ | ìš©ë„ |
|--------|------|------|
| @nestjs/core | 10.x | ì›¹ í”„ë ˆì„ì›Œí¬ |
| @prisma/client | 6.x | ORM |
| @nestjs/passport | 10.x | ì¸ì¦ |
| @nestjs/jwt | 10.x | JWT |
| @nestjs/swagger | 8.x | API ë¬¸ì„œ |
| class-validator | 0.14.x | DTO ê²€ì¦ |

### Mobile (apps/mobile)

| íŒ¨í‚¤ì§€ | ë²„ì „ | ìš©ë„ |
|--------|------|------|
| expo | 53.x | ê°œë°œ í”Œë«í¼ |
| expo-router | 4.x | íŒŒì¼ ê¸°ë°˜ ë¼ìš°íŒ… |
| expo-sqlite | 15.x | ë¡œì»¬ DB |
| zustand | 5.x | ìƒíƒœ ê´€ë¦¬ |
| react-native-reanimated | 3.x | ì• ë‹ˆë©”ì´ì…˜ |

---

## 8. ì°¸ê³  ë¬¸ì„œ

| ë¬¸ì„œ | ìœ„ì¹˜ | ì„¤ëª… |
|------|------|------|
| PRD v1.1 | `docs/prd/PRD_travel-expense-tracker.md` | í”„ë¡ íŠ¸ì—”ë“œ MVP ìš”êµ¬ì‚¬í•­ |
| PRD v3.0 | `docs/prd/PRD-v3-backend-ai.md` | ë°±ì—”ë“œ + AI ìš”êµ¬ì‚¬í•­ |
| Data Schema | `docs/prd/PRD-data-schema-contract.md` | íƒ€ì… ì •ì˜ SSOT |
| ë¶„ì„ ë³´ê³ ì„œ | `docs/prd/PRD-analysis-report.md` | PRD ë¶„ì„ ê²°ê³¼ |

---

## 9. í–¥í›„ ê³„íš

- [ ] Mobile â†’ `@wigtn/shared` íƒ€ì… ë§ˆì´ê·¸ë ˆì´ì…˜
- [ ] Upload ëª¨ë“ˆ (Presigned URL for S3)
- [ ] CI/CD íŒŒì´í”„ë¼ì¸
- [ ] í”„ë¡œë•ì…˜ ë°°í¬
- [ ] ëª¨ë‹ˆí„°ë§ (Sentry, Analytics)
